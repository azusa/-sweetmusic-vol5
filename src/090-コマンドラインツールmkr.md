\lhead[]{}
\rhead[]{}
\chead[コマンドラインツールmkr]{コマンドラインツールmkr}

# コマンドラインツールmkr

MackerelではコマンドラインツールがOSSとして^[[https://github.com/mackerelio/mkr](https://github.com/mackerelio/mkr)]
提供されています。

インストールは`yum`または`apt`コマンドによって行います。([@lst:code_090_a])

```{#lst:code_090_a caption="mkrのインストール"}
sudo yum install mkr
```

[@lst:code_090_b]および[@lst:code_090_c]に示すのは、サーバーののバックアップ処理時に
サーバーのプロセスが停止している際に、ヘルスチェックの警告が発生しないよう、
Mackerlのホストのステータスを `maintenance`とし、バックアップ処理の終了後に
`working`に復帰するものです。

`mackerel-agent`が起動しているホストでは`/var/lib/mackerel-agent/id`に
ホストを識別するidが格納されているので、このidを`mkr`コマンドに引き渡すようにしています。

```{#lst:code_090_b caption="ステータスをmaintenanceにする"}
export MACKEREL_APIKEY=<APIキー>
cat /var/lib/mackerel-agent/id |xargs mkr update --status maintenance
```


```{#lst:code_090_c caption="ステータスをworkingにする"}
export MACKEREL_APIKEY=<APIキー>
sleep 5
cat /var/lib/mackerel-agent/id |xargs mkr update --status working
```





